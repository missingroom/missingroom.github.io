---
title: 鞅与停时定理学习笔记
tags: 数学 概率期望
---

# 鞅与停时定理

## 离散时间鞅

定义**离散时间鞅**为一个时间离散的随机过程 $\{X_0,X_1,\cdots\}$，使得 $\forall n\in \N$，均满足：

- $E(|X_n|)<\infin$；
- $E(X_{n+1}-X_n\mid X_0,X_1,\cdots,X_n)=0$；

根据这个，容易得到 $E(X_n)=X_0$。

## 停时定理

设 $t$ 为鞅过程 $\{X_0,X_1,\cdots\}$ 的停时，当下面三个条件之一成立时，有 $E(X_t)=X_0$：

- $t$ 几乎必然有界；
- $|X_{i+1}-X_i|$ 一致有界，$E(t)$ 有限；
- $X_i$ 一致有界，$t$ 几乎必然有限。

名词解释：

- $a\in\R\cup\{\infin\}$ 有限：$|a|<\infin$；
- $a\in\R\cup\{\infin\}$ 有界：$\exist l,r\in \R,a\in[l,r]$；
- $a_i\in\R\cup\{\infin\}$ 一致有界：$\forall i,\exist l,r\in \R,a_i\in[l,r]$；
- 事件 $A$ 几乎必然发生：$P(A)=1$。

## 势能函数

对于随机时间序列 $\{A_0,A_1,\cdots\}$，$t$ 为其停时，终止状态为 $A_t$，求 $E(t)$。

构造势能函数 $\Phi(A)$，满足：

- $E(\Phi(A_{n+1})-\Phi(A_n)\mid A_0,A_1,\cdots,A_n)=-1$；
- $\Phi(A_t)$ 为常数。

构造序列 $X_i=\Phi(A_i)+i$，则 $E(X_{n+1}-X_n\mid X_0,X_1,\cdots,X_n)=0$，即 $\{X_0,X_1,\cdots\}$ 是鞅。

根据停时定理，我们可以得到 $E(X_t)=E(X_0)$，即 $E(t)=E(\Phi(A_0))-\Phi(A_t)$。

## 例题

### [CF1025G Company Acquisitions](https://www.luogu.com.cn/problem/CF1025G)

设 $f(x)$ 为跟随有 $x$ 个未选中点的选中点的势能函数，整个局面的势能函数为 $\Phi(A)$，每个选中点的势能函数的和。

显然每次操作的势能变化量只和随出来的两个点有关，$u,v$ 的儿子数设为 $x,y$。

为满足 $E(\Phi(A_{n+1})-\Phi(A_n)\mid A_0,A_1,\cdots,A_n)=-1$，有


$$
f(x)+f(y)-1=\frac{1}{2}(f(x+1)+yf(0))+\frac{1}{2}(f(y+1)+xf(0))
$$


因为我们要对于任意 $x,y$ 成立，所以


$$
f(x)-\frac{1}{2}=\frac{1}{2}f(x+1)+\frac{x}{2}f(0)
$$


取 $f(0)=0$，则 $f(x)=1-2^x$。

设停时为 $t$，注意到 $\Phi(A_t)=f(n-1)=1-2^{n-1}$ 为常数，所以 $E(t)=\Phi(A_0)-\Phi(A_t)$。



